<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="alarm">

	<select id="selectAlarm" resultType="AlarmVo">
		<![CDATA[
			SELECT  a.alarm_date,
			        u.user_id,
			        b.b_buy_player_state,
			        b.buy_del_state,
			        u.user_id,
			        g.gym_name,
			        p.prod_name,
			        a.alarm_content,
			        a.alarm_no,
			        a.from_user_no,
			        a.to_user_no,
			        a.sell_type,
			        u.user_no
			FROM    alarm a, users u, bbuy b, gym g, buy b, product p
			WHERE   a.from_user_no = u.user_no
					and u.user_no = 1
			ORDER BY a.alarm_no desc
		]]>
	</select>

	<insert id="send_product_alarm" parameterType="AlarmVo">
		<![CDATA[
			INSERT INTO alarm VALUES(seq_alarm_no.nextval, #{from_user_no}, '2',  #{alarm_content}, '배송', sysdate)
		]]>
	</insert>

	<update id="payment_complete" parameterType="BuyVo">
		<![CDATA[
			UPDATE buy SET buy_del_state = '결제완료' WHERE buy_no = 1
		]]>
	</update>

	<update id="delivery_ready" parameterType="BuyVo">
		<![CDATA[
			UPDATE buy SET buy_del_state = '배송준비중' WHERE buy_no = 1
		]]>
	</update>

	<update id="delivery_ing" parameterType="BuyVo">
		<![CDATA[
			UPDATE buy SET buy_del_state = '배송중' WHERE buy_no = 1
		]]>
	</update>

	<update id="delivery_complete" parameterType="BuyVo">
		<![CDATA[
			UPDATE buy SET buy_del_state = '배송완료' WHERE buy_no = 1
		]]>
	</update>

	<insert id="send_matching_alarm" parameterType="AlarmVo">
		<![CDATA[
			INSERT INTO alarm VALUES(seq_alarm_no.nextval, #{from_user_no}, '4',  #{alarm_content}, '매칭', sysdate)
		]]>
	</insert>

	

</mapper>