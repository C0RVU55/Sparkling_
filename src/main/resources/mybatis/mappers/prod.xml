<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="prod">



	<insert id="insert" parameterType="com.javaex.vo.ProductVo" >
		<selectKey keyProperty="prod_no" resultType="String" order="BEFORE">
			select SEQ_prod_no.nextval
			from dual
		</selectKey>
      <![CDATA[
         insert into product
         values( #{prod_no},
                 #{sell_no},
                 #{prod_cate},
                 #{event_cate},
                 #{prod_name},
                 #{prod_price},
                 #{prod_brand},
                 #{prod_desc},
                 #{prod_from},
                 #{prod_wash},
                 #{prod_qual},
                 #{prod_detail},
                 #{prod_detail_img_name},
                 #{prod_detail_img_savename},
                 sysdate
                 )          
      ]]>
	</insert>
	
	<insert id="imgInsert" parameterType="com.javaex.vo.ProdimgVo">
	<![CDATA[
		insert into prodimg values (SEQ_PROD_IMG_NO.nextval, 
									#{prod_no}, 
									#{prod_img_name}, 
									#{prod_img_savename}, 
									#{prod_img_type})
	]]>
	</insert>
	
		<insert id="imgColorSize" parameterType="com.javaex.vo.ColorsizeVo">
	<![CDATA[
		insert into colorsize VALUES(seq_colorsize_no.nextval, 
		                             #{prod_no}, 
		                             #{prod_size}, 
		                             #{color}, 
		                             #{stock})
	]]>
	</insert>
	
	<select id="prodSelectList" parameterType="int" resultType="com.javaex.vo.ProductVo">
		<![CDATA[
			SELECT p.sell_no,
			       p.prod_no,
			       i.prod_no,
			       p.event_cate,
			       p.prod_name,
			       p.prod_brand,
			       p.prod_price,
			       to_char(p.prod_date, 'yyyy-mm-dd') prod_date,
			       i.prod_img_no,
			       i.prod_img_savename,
			       i.prod_img_type
			FROM product p, prodimg i
			where p.prod_no = i.prod_no
			and i.prod_img_type = 'main'
			and sell_no = #{sell_no}
		]]>
	</select>
	
	<select id="prodSelectOne" parameterType="String" resultType="com.javaex.vo.ProductVo">
		<![CDATA[
			select prod_no,
			       prod_cate,
			       event_cate,
			       prod_name,
			       prod_price,
			       prod_brand,
			       prod_desc,
			       prod_from,
			       prod_wash,
			       prod_qual,
			       prod_detail,
			       prod_detail_img_name,
			       prod_detail_img_savename
			from product
			where prod_no = #{prod_no}	
		]]>
	</select>

	<select id="colorsizeSelectList" parameterType="String" resultType="com.javaex.vo.ColorsizeVo">
		<![CDATA[
			SELECT prod_no,
			       colorsize_no,
			       color,
			       prod_size,
			       stock
			FROM colorsize
			where prod_no = #{prod_no}
		]]>
	</select>
	
	<select id="imgSelectList" parameterType="String" resultType="com.javaex.vo.ProdimgVo">
		<![CDATA[
			select prod_no,
			       prod_img_no,
			       prod_img_name,
			       prod_img_savename
			from prodimg
			where prod_no = #{prod_no}
		]]>
	</select>
</mapper>