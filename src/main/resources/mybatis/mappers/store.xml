<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace= "store">
	
	<resultMap id ="QnaVo" type="QnaVo">
		<result column ="qna_no" property="qnaNo"/>
		<result column ="prod_no" property="prodNo"/>
		<result column ="qna_title" property="qnaTitle"/>
		<result column ="qna_content" property="qnaContent"/>
		<result column ="qna_date" property="qnaDate"/>
		<result column ="Qna_type" property="QnaType"/>
		<result column ="user_no" property="userNo"/>
		<result column ="buy_no" property="buyNo"/>  
	</resultMap>
	
	<resultMap id ="QnaimgVo" type="QnaimgVo">
		<result column ="qna_img_no" property="qnaImgNo"/>
		<result column ="qna_no" property="qnaNo"/>
		<result column ="qna_img_name" property="qnaImgName"/>
		<result column ="qna_img_savename" property="qnaImgSavename"/>
		<result column ="qna_img_type" property="qnaImgType"/>
	</resultMap>

	
	<!-- qna 인서트 -->
	<!-- qnaimg가 있을 경우 거의 동시에 인서트 되는데, qnaimg에서 qna_no가 필요하므로  selectKey 사용. 우선 입력한 값의 결과값을 다음 쿼리로 바로 return 시켜준다.-->
	<insert id="qnaInsert" parameterType="QnaVo">
		<selectKey keyProperty="qna_no" resultType="Int" order="BEFORE">
			select SEQ_QNA_NO.nextval from dual
		</selectKey>
		<![CDATA[
			insert into qna
            values(
                #{qna_no},
                #{prod_no},
                #{qna_title},
                #{qna_content},
                sysdate,
                #{qna_type,jdbcType=VARCHAR},
                #{user_no},
                #{buy_no}
            )
		]]>
	</insert>
	
	<!-- qnaimg 인서트 -->
	<insert id="qnaimgInsert" parameterType="QnaimgVo">
		<![CDATA[
			insert into qnaimg
            values(
                SEQ_QNA_IMG_NO.nextval,
                #{qna_no},
                #{qna_img_name},
                #{qna_img_savename},
                #{qna_img_type}
            )
		]]>
	</insert>

	
   
</mapper>